To-do's:
- Update abadea peary repo with most updated spacely-caribou-reference slides it says to "Pull the aq_dev branch to get the latest I2C bus names for ZCU102" on peary. We did not do this and are working on the badea_052824 branch.

# Steps to get test stand functioning

Test stand hardware:
- ZCU102 (maybe cheaper alternative in future). <= $3600
- Xilinx mezzanine
- Linux machine
	- Need python >=3.10
- (future) scope
- (future) power supply
- (future) Car board <= Euros 1200 -> will include level shifter + pulsers on it

Useful resources:
- Adamâ€™s Spacely-Caribou-Reference slides should get us setup nearly all the way

Install Petalinux on SD card into FPGA:
- fill me in

Connect to FPGA:
- install vivado
- install the drivers for zcu102 using https://docs.amd.com/r/2022.1-English/ug973-vivado-release-notes-install-license/Install-Cable-Drivers
- connect both JTAG and UART cables

Flash the fpga:
- open vivado
- open project. select file /asic/projects/C/CMS_PIX_28/testing/spacely-caribou-common-blocks/ZCU102_LED_Demo_FW/demo2_led.xpr
- on the left hand side: Program and debug -> Open Hardware Manager -> Open Target -> Auto Connect
- on the left hand side: Program and debug -> program device -> xczu9_0 -> program

Setup spacely:
- git clone 
- cd /asic/projects/C/CMS_PIX_28/testing/spacely/PySpacely/
- git clone git@github.com:Fermilab-Microelectronics/spacely-asic-config.git
- cd /asic/projects/C/CMS_PIX_28/testing/spacely/PySpacely/requirements
- Create virtual environment with python 3.10 which supports all of the packages inside of the requirements txt files
```
export PROJECT_DIR=/asic/projects/C/CMS_PIX_28/testing/
mkdir -p $PROJECT_DIR/miniconda3
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O $PROJECT_DIR/miniconda.sh
bash $PROJECT_DIR/miniconda.sh -b -u -p $PROJECT_DIR/miniconda3
rm -rf $PROJECT_DIR/miniconda.sh
$PROJECT_DIR/miniconda3/bin/conda init bash
conda create --name spacelyvenv python=3.10
conda activate spacelyvenv
pip install -r requirements-py-libs-common.txt
pip install -r requirements-python.txt
```

Setup peary:
- On linux machine:
	- git clone https://gitlab.cern.ch/adquinn/peary.git
	- git checkout aq_dev
	- cd ..
	- scp peary petalinux@192.168.1.24:/home/petalinux/
	- download cmake file from https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://github.com/Kitware/CMake/releases/download/v3.29.0-rc4/cmake-3.29.0-rc4-linux-aarch64.sh&ved=2ahUKEwiDlqiZ3dSGAxUy58kDHYVWBRMQFnoECBgQAQ&usg=AOvVaw3ZrpaDb5hiBprq2dVg650P
	- scp cmake-3.29.0-rc4-linux-aarch64.sh  petalinux@192.168.1.24:/home/petalinux/
- ssh petalinux@192.168.1.24
	- export PATH=/home/petalinux/cmake-3.29.0-rc4-linux-aarch64/bin/:$PATH
	- cd peary
	- mkdir build
	- cd build
	- cmake -DBUILD_SMARTPIX28=ON -DBUILD_ZCU102_LED_Demo=ON -DINTERFACE_IIO=OFF -DINTERFACE_MEDIA=OFF -DINTERFACE_I2C=OFF ..
	- make -j4
	- make install
	- sudo ./bin/pearycli


Steps to run ZCU LED demo at end of day:
- cd /asic/projects/C/CMS_PIX_28/testing/spacely/PySpacely
- conda activate spacelyvenv
- python Spacely.py